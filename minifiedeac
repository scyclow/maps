ORCE_GRADIENTS=!0,INVERT_STREETS=!0):prb(.5)&&LAYER_N<=4&&(INVERT_STREETS=!0)):5===COLOR_RULE&&(NOISE_DIVISOR=rnd(350,1e3)/SCALE,LAYER_N=50,BASE_RULE=chance([1,"paper"],[1,"faded"],[1,"bright"],[1,"whiteAndBlack"]),HUE_DIFF=chance([6,0],[2,20],[1,120],[1,180])*posOrNeg()),("blackAndWhite"===BASE_RULE||"neon"===BASE_RULE&&LAYER_N>2&&3!==COLOR_RULE)&&(HUE_DIFF=chance([1,0],[2,180])*posOrNeg()),2===LAYER_N&&["neon","burnt"].includes(BASE_RULE)&&(HUE_DIFF=chance([5,0],[1,100],[1,120],[1,150],[1,180])*posOrNeg());const e=scaleModifier(1,1.6)*(LOW_INK?.7:1);if(MIN_ST_W=.7*e,MAX_ST_W=1.3*e,GRAIN=rnd()<.5||["blackAndWhite","neon","burnt"].includes(BASE_RULE)?0:rnd(.2,.7),X_OFF=0,Y_OFF=0,MISPRINT_ROTATION=0,BORDER_BLEED=prb(.5),HARD_BORDER=BORDER_BLEED||prb(.8),BORDER_PADDING=chance([5,rnd(175,200)],[75,rnd(30,60)],[20,rnd(20,30)])/SCALE,BORDER_THICKNESS=map(SCALE,.2,1.2,1.6,2.8)+rnd(-.2,.2),BORDER_DRIFT=chance([5,0],[3,rnd(3)/SCALE],[1,rnd(3,BORDER_PADDING/2)/SCALE]),ROTATION=rnd(-5e-4,5e-4),X_OFF=rnd(-2,2)/SCALE,Y_OFF=rnd(-2,2)/SCALE,IS_MISPRINT=prb(.015),!HARD_BORDER&&BORDER_PADDING*SCALE<=30&&(BORDER_DRIFT=BORDER_PADDING-5/SCALE,HARD_BORDER=!1,BORDER_BLEED=!1),IS_MISPRINT){HARD_BORDER=!0,BORDER_BLEED=!0,BORDER_THICKNESS=rnd(1.4,3),BORDER_DRIFT=chance([5,0],[3,rnd(3)/SCALE],[1,rnd(3,BORDER_PADDING/2)/SCALE]);const r=prb(.333)?2:1;X_OFF=rnd(-250,250)/(r*SCALE),Y_OFF=rnd(-250,250)/(r*SCALE),MISPRINT_ROTATION=rnd(-QUARTER_PI,QUARTER_PI)/(4*r)}BORDER_DRIFT=min(180/SCALE,BORDER_DRIFT),SHADOW_X=5*posOrNeg(),SHADOW_Y=5*posOrNeg(),SHADOW_MAGNITUDE=chance([15,0],[80,1],[4,2],[MAX_GRADIENT>200?20:1,10])}LAYERS=[],NOISE_OFFSET=1e5;
const t=(t,e,n,g)=>{if(g){const o=g.useElevation?10*X(t,e):dist(t,e,g.focalPoint.x,g.focalPoint.y)/dist(L,B,R,T),i=r(w(hue(n)+map(o,0,1,0,g.hue)),saturation(n)+map(o,0,1,0,g.sat),brightness(n)+map(o,0,1,0,g.brt));stroke(i),fill(i)}else stroke(n),fill(n)},e=t=>t>=90&&t<=150||t>=270&&t<=330;function r(t,r,n,g){t=w(t);let o=0;return e(t)&&(o=1-abs(120-t%180)/30),r=map(o,0,1,r,.65*r),color(t,r,n)}const n=()=>{};function g(t,e){const r=g38<.4&&g38>=.3?.05:g38<.3?.35-g38:0;return map(r,0,.15,t,e)}const o=({x:t,y:e})=>[t,e];function i(t,e,r){if(!r.length)return!1;const n=o(t),g=o(e);return r.some(r=>{if(r.coords.length<10)return u(o(t),o(e),o(r.coords[0]),o(E(r.coords)));const i=r.coords.length<20?2:r.coords.length<40?4:r.coords.length<70?7:10;for(let t=0;t<r.coords.length;t+=i){const e=o(r.coords[t]),a=o(r.coords[t+i]||E(r.coords)),c=u(n,g,e,a);if(c)return c}return!1})}const a=t=>(e,r)=>e<L+t+p(-g14,g14)||e>R-t+p(-g14,g14)||r<T+t+p(-g14,g14)||r>B-t+p(-g14,g14);function c(t,e,r,g,o,i=n,a=!1){const{d:c,angle:s}=d(t,e,r,g);let l=t,h=e;for(let t=0;t<=c;t++){if(a&&t>=.6*c)return;i(l,h)||g35&&y(.7)||g20&&y(.2)||o(l,h,t/c,s),[l,h]=b(s,1,l,h)}}function s(t,e,r,n,g){c(t-r/2,e-n/2,t+r/2,e-n/2,g),c(t-r/2,e+n/2,t+r/2,e+n/2,g),c(t-r/2,e-n/2,t-r/2,e+n/2,g),c(t+r/2,e-n/2,t+r/2,e+n/2,g)}function l(...t){const e=t.reduce((t,e)=>t+e[0],0),r=p();let n=0;for(let g=0;g<t.length;g++)if(r<=(n+=t[g][0]/e))return t[g][1]}const d=(t,e,r,n)=>({d:dist(t,e,r,n),angle:atan2(r-t,n-e)});function h(t,e){if(dist(t[0],t[1],e.x,e.y)>e.r)return!1;const r=[2*width,2*height];return e.coords.reduce((n,g,o)=>{const i=(o+1)%e.coords.length,a=e.coords[i];return u(t,r,g,a)?n+1:n},0)%2==1}function u([t,e],[r,n],[g,o],[i,a]){const c=(r-t)*(a-o)-(i-g)*(n-e);if(0===c)return!1;const s=((a-o)*(i-t)+(g-i)*(a-e))/c,l=((e-n)*(i-t)+(r-t)*(a-e))/c;return s>0&&s<1&&l>0&&l<1?[t+s*(r-t),e+s*(n-e)]:null}function b(t,e,r=0,n=0){return[sin(t)*e+r,cos(t)*e+n]}function f(t,e){const r=[];for(let n=0;n<t;n++)r.push(e(n));return r}let A=parseInt(tokenData.hash.slice(50,58),16);const k=(t,e)=>int(p(t,e));function p(t,e){A^=A<<13,A^=A>>17;const r=((A^=A<<5)<0?1+~A:A)%1e3/1e3;return null!=e?t+r*(e-t):null!=t?r*t:r}function m(t){const e=tokenData.hash.slice(2+2*t,4+2*t);return parseInt(e,16)/255}const y=t=>p()<t,I=(t,e,r,n)=>r+noise(t/15,e/15)*(n-r)+p(-.25,.25),_=()=>y(.5)?1:-1,x=t=>t[int(p(t.length))],P=t=>!!t,E=t=>t[t.length-1],w=t=>(t%360+360)%360,D=t=>(299*red(t)+587*green(t)+114*blue(t))/1e3,C=(t,e)=>(D(t)-D(e))/255;function v(t,e,r,n){push();const g=g36[0];background(g.colors.bg);const o=a(g8),i=2/g38,c=g36.map((t,e)=>{const r=t.isColor&&g.isDark,n=t.isLight&&g.isDark,o=g.isColor&&t.isDark,i=r||o,a=g.isLight&&t.isDark,c=0===e||e===g36.length-1;return{potentialMismatch:i||a,multiplier:c&&t.gradient?map(g38,.2,1.2,2.6,1.5):c&&o?max(1,1.1/g38):c&&r?max(1,.75/g38):c&&a?max(1,1.5/g38):i?max(1,1/g38):a?max(1,.7/g38):n?max(1,.7/g38):1}}),s=5/g38;for(let g=t-s;g<e+s;g+=i){let t=i;for(let e=r-s;e<n+s;e+=t){const r=!g13&&g8>0&&o(e,g)?g36[0]:j(e,g);S(e,g,r,t=i/c[r.ix].multiplier,c[r.ix])}}pop()}function S(t,e,n,g,o){if(g35&&y(.5))return;const i=p(g,2*g)*o.multiplier/3.5,a=o.multiplier>1?2*i:0,c=X(t,e);strokeWeight(i);let s=0,l=0,d=0;if(n.gradient){const r=n.gradient.useElevation?10*c:dist(t,e,n.gradient.focalPoint.x,n.gradient.focalPoint.y)/dist(L,B,R,T);s=map(r,0,1,0,n.gradient.hue),l=map(r,0,1,0,n.gradient.sat),d=map(r,0,1,0,n.gradient.brt)}const{bShadow:h,sShadow:u}=F(t,e,c,n),f=45*g42+3,A=10*g42+5,k=5*g42*(o.potentialMismatch?0:1);stroke(r(w(hue(n.colors.bg)+s+p(-f,f)),saturation(n.colors.bg)+l+p(-A,A)+u,brightness(n.colors.bg)+d+p(-10-k,0)-h));const m=noise(t+g12,e+g12),[I,_]=b(PI+m+p(-QUARTER_PI,QUARTER_PI),5,t+p(-a,a+g37),e+p(-a,a)),[x,P]=b(m+p(-QUARTER_PI,QUARTER_PI),5,t,e);line(I,_,x,P)}function F(t,e,r,n){const g=max(0,X(t+g29,e+g30)-r)*g6*(g10*g38)/300,o=map(D(n.colors.bg),0,255,.5,1),i=n.gradient?4*min(abs(n.gradient.hue)/50,1):1;let a=0,c=0;return n.isDark?(a=500*g,c=500*g):n.isColor?(magnitude=150*i*o,a=g*magnitude,c=g*magnitude*(n.gradient?4:2)):n.isLight&&(a=100*g*i,c=100*g*i),{sShadow:c,bShadow:a}}function M(e,r){push();const{primaryAveCoords:n,secondaryAveCoords:g,tertiaryAveCoords:o,quarternaryAveCoords:i,streetCoords:a}=U(),c=g20?1.75:.5,s=g20?1.25:0,l=.4*c,d=1.6*s,h=.8*c,u=1.2*s;a.forEach((n,g)=>Q(n.coords,(n,g)=>{const o=n+p(-l,l)+e,i=g+p(-l,l)+r,a=j(o,i);a.hideStreets||V(a.ix)||(t(o,i,a.colors.street,a.gradient),g1?f(g35?2:5,()=>{const t=I(o,i,0,20);circle(o+p(-t,t),i+p(-t,t),p(1*g31,1*g32))}):circle(o,i,I(o,i,g31,g32)+d))},e,r)),i.forEach(n=>Q(n.coords,(n,g)=>{const o=n+p(-h,h)+e,i=g+p(-h,h)+r,a=j(o,i);a.hideStreets||V(a.ix)||(t(o,i,a.colors.quarternary,a.gradient),circle(o,i,I(o,i,2*g31,2*g32)+u))},e,r)),o.forEach(n=>Q(n.coords,(n,g)=>{const o=n+p(-c,c)+e,i=g+p(-c,c)+r,a=j(o,i);a.hideStreets||V(a.ix)||(t(o,i,a.colors.tertiary,a.gradient),circle(o,i,I(o,i,3.5*g31,3.5*g32)+s))},e,r)),g.forEach(n=>Q(n.coords,(n,g)=>{const o=n+p(-c,c)+e,i=g+p(-c,c)+r,a=j(o,i);a.hideStreets||V(a.ix)||(t(o,i,a.colors.secondary,a.gradient),circle(o,i,I(o,i,5*g31,5*g32)+s))},e,r)),Q(n.coords,(n,g)=>{const o=n+p(-c,c)+e,i=g+p(-c,c)+r,a=j(o,i);a.hideStreets||V(a.ix)||(t(o,i,a.colors.primary,a.gradient),circle(o,i,I(o,i,6.25*g31,6.25*g32)+s))},e,r),pop()}function Q(e,r,n=0,g=0){const o=a(g8),i=y(g23);e.forEach((a,s)=>{const{x:l,y:d}=a;if(s>0){const{x:t,y:n}=e[s-1];c(t,n,l,d,r,o,i)}if(!o(l,d)&&s===e.length-1&&!g2&&!g1){push();const e=j(l+n,d+g);if(e.hideStreets||V(e.ix)||g35&&y(.8))return;t(l+n,d+g,e.colors.circle,e.gradient);const r=g20;f(10,t=>{const e=g27&&y(.001)?q:circle,o=g35?p(1,6):8;e(l+p(-r,r)+n,d+p(-r,r)+g,o)}),pop()}})}function U(){const t=map(g38,.2,1.2,.1,.17),e=0===g34?.05:2===g34&&.5,r=(t,r,n,g=1)=>e?e*g:t+(r-t)*(1-X(n.x,n.y));SECONDARY_PRB=e||p(t,.2),TERTIARY_PRB=e?1.5*e:p(t,.2),QUARTERNARY_PRB=e?1.5*e:p(2*t,.4),STREET_PRB=e?2*e:p(.25,1),STREET_BLOCK_HEIGHT=20;const n=g5?100:g(17,24);PRIMARY_DRIFT=HALF_PI/n,SECONDARY_DRIFT=HALF_PI/p(n,2*n),TERTIARY_DRIFT=HALF_PI/(g16?2:p(3*n,6*n)),QUARTERNARY_DRIFT=HALF_PI/(g16?2:p(3*n,6*n)),STREET_DRIFT=HALF_PI/(g16?2:p(3*n,6*n));const o=p(T,B),i=p(L,R),a=Y(...l([.25,[i,B+25,d(i,B,0,0).angle]],[.25,[i,T-25,d(i,T,0,0).angle]],[.25,[L-25,o,d(L,o,0,0).angle]],[.25,[R+25,o,d(R,o,0,0).angle]]),{driftAmt:PRIMARY_DRIFT,maxLen:300,ix:0});let c=0,s={};const h=a.coords.map((e,n)=>{const g=r(t,.2,e);if(y(g)&&n<250){const t=c++,r=p()<.5?1:-1;if(s[r]&&s[r]+3>n)return;s[r]=n;const g=-1===r?HALF_PI:PI+HALF_PI;return Y(e.x,e.y,e.angle+g,{direction:r,branch:t,driftAmt:SECONDARY_DRIFT,maxLen:200})}}).filter(P),u=h.flatMap((e,n)=>{return e.coords.map(e=>{const g=r(t,.2,e,1.5);if(y(g)&&n<150){const t=p()<.5?1:-1,r=-1===t?HALF_PI:PI+HALF_PI,n={direction:t,driftAmt:TERTIARY_DRIFT,stopAtIntersections:[a,...h]};return Y(e.x,e.y,e.angle+r,n)}}).filter(P)}),b=u.flatMap(e=>e.coords.map(e=>{const n=r(2*t,.4,e,1.5);if(y(n)){const t=p()<.5?1:-1,r=-1===t?HALF_PI:PI+HALF_PI,n={direction:t,driftAmt:QUARTERNARY_DRIFT,stopAtIntersections:[a,...h,...u]};return Y(e.x,e.y,e.angle+r,n)}}).filter(P)),f=h.flatMap(t=>t.coords.flatMap(t=>{const e={driftAmt:STREET_DRIFT,stopAtIntersections:[a,...h,...u,...b]},n=r(.25,1,t,2);return[y(n)&&Y(t.x,t.y,t.angle+HALF_PI,e),y(n)&&Y(t.x,t.y,t.angle+HALF_PI+PI,e)].filter(P)}));return{primaryAveCoords:a,secondaryAveCoords:h,tertiaryAveCoords:u,quarternaryAveCoords:b,streetCoords:f}}function Y(t,e,r,n={}){const g=n.driftAmt||HALF_PI/16,o=n.stopAtIntersections||[],c=n.maxLen||150,s=a(-180/g38);let l=t,d=e,h=r;const u=[];for(let t=0;t<c;t++){const e=b((h=map(noise(l+g12,d+g12),0,1,h-g,h+g))+(g0&&j(l,d).ix>0?g0:0),STREET_BLOCK_HEIGHT,l,d),r=e[0],n=e[1];if(t){if(i({x:l,y:d},{x:r,y:n},o))break}if(l=r,d=n,u.push({x:l,y:d,angle:h}),s(l,d))break}return{coords:u,direction:n.direction||0,branch:n.branch||0}}const q=(t,e,r)=>{push();const n=n=>b(n*TWO_PI/10,n%2==0?r/2:r,t,e);beginShape(),curveVertex(...n(-1)),f(12,t=>{curveVertex(...n(t))}),endShape(),pop()};function N(){if(g17){const e=g8<50?p(1.7,2.1):p(1.98,2.02);s(g40,g41,W-g8*e,H-g8*e,(e,r)=>{const n=g13?j(e,r,!0):g36[0];n.hideStreets||V(n.ix)||(t(e+g40,r+g41,n.colors.circle,n.gradient),circle(e,r,I(e,r,g4/g38,2.5*g4/g38)))})}}function O(){const{elevationAverage:t,elevationMin:e}=J(),r=G(),n=p(360);g36=[{ix:0,threshold:g33>=30?e:t,hideStreets:!1,...r[g22](n,g15/p(3,15),0,g11)}];const g=["whiteAndBlack","paper"].includes(g22),o=["bright","faded"].includes(g22),i=5===g19&&o?x(["bright","whiteAndBlack"]):!(5!==g19||!g)&&"bright";let a=0;const c=z(n),s=(t,e,n)=>{const g=y(.2)&&!g3,o=n===g33-1?g15/p(3,8):g15;let s;if(5!==g19||n%2)if(5===g19&&n%2){l([1,20],[1,120],[1,180]);const e=w(t.baseHue+20);s=r[i](e,o,n,t.isDark)}else{const e=l(...t.neighbors),g="blackAndWhite"===e||"whiteAndBlack"===e?t.baseHue:(t=>"path"===g28?t+g25:c[a++%c.length])(t.baseHue);s=r[e](g,o,n,t.isDark)}else s=g36[0];return{hideStreets:g,...s,ix:n,threshold:e}};for(let t=1;t<g33;t++){const e=g36[t-1],r=t===g33-1?1:e.threshold+.02;g36.push(s(e,r,t))}}const G=()=>{const t=color(0,0,10),e=color(0,0,90),n=color(0,0,85),g=(t,e=360)=>p()<.09||t?{focalPoint:{x:p(L,R),y:p(T,B)},useElevation:p()<.9,hue:p(e/4,e)*_(),sat:2,brt:1}:null;return{blackAndWhite:(e,r,g,o)=>{let i;return i=[2,4].includes(g19)?"light":3===g19?"dark":4===g19?"color":"all",{name:"blackAndWhite",baseHue:e,colors:{bg:t,primary:n,secondary:n,tertiary:n,quarternary:n,street:n,circle:n},neighbors:{contrast:[[1,"whiteAndBlack"],[1,"bright"]],light:[[8,"whiteAndBlack"],[2,"bright"]],dark:[[1,"neon"]],color:[[1,"bright"]],all:[[7,"whiteAndBlack"],[3,"bright"],[3,"neon"]]}[i],gradient:null,isDark:!0,isColor:!1,isLight:!1}},whiteAndBlack:(r,n,g,o)=>{let i;i=1===g19?"contrast":3===g19?"dark":[2,4].includes(g19)?"color":"all";const a={contrast:[[g33>3?1:0,"bright"],[3,"blackAndWhite"]],dark:[[5,"blackAndWhite"],[5,"neon"]],color:[[1,"bright"]],all:[[6,"blackAndWhite"],[5,"neon"],[5,"bright"]]}[i];return{name:"whiteAndBlack",baseHue:r,colors:{bg:e,primary:t,secondary:t,tertiary:t,quarternary:t,street:t,circle:t},neighbors:a,gradient:null,isDark:!1,isColor:!1,isLight:!0}},neon:(t,e,n,o)=>{const i=r(t,30,o?22:12);let a,c=r(t,55,92);return C(i,c)>-.5&&(c=Z(i,c,-.5)),{name:"neon",baseHue:t,colors:{bg:i,primary:c,secondary:c,terti